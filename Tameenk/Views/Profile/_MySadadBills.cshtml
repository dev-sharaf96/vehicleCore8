@model Tameenk.Services.Profile.Component.Output.MySadadBillsOutput
@using Tameenk.Resources.Profile;
@using Tameenk.Core.Domain.Enums;
@{
    double pages = (double)Model.SadadBillsCount / 10;
    var pagesCount = Math.Ceiling(pages);
    //var payedIds = new List<int> { 2, 4, 5, 6, 7 };
}

<article id="MySadadBillsList">
    @if (Model != null && Model.SadadBillsList != null && Model.SadadBillsList.Count > 0)
    {
        foreach (var item in Model.SadadBillsList)
        {
            <div class="wrapper-bx md-mar vehicle-row  search-info bg-ofwhite section  active search-car" style="background-image: url('/resources/imgs/CarLogos/@(item.VehicleMakerCode.HasValue ? item.VehicleMakerCode.Value.ToString("0000") : "0000").jpg');">
                <div class="row">
                    <div class="col-xs-12 col-lg-3 col-lg-2 bx-right">
                    </div>
                    <header class="col-xs-12 col-lg-3  over-hidden bx-right">
                        <span class="txt-sm  txt-mgray dis-block ">@Html.Raw(Tameenk.LangText.InsuranceCompanyName)</span>
                        @if (System.Globalization.CultureInfo.CurrentCulture.TwoLetterISOLanguageName.Equals(LanguageTwoLetterIsoCode.En.ToString(), StringComparison.OrdinalIgnoreCase))
                        {
                            <h2 class="txt-lr txt-black no-mar">@item.InsuranceCompanyNameEn </h2>
                        }
                        else
                        {
                            <h2 class="txt-lr txt-black no-mar">@item.InsuranceCompanyNameAr </h2>
                        }
                        <span class="txt-sm  txt-mgray dis-block ">@Html.Raw(Tameenk.LangText.search_Vehicle_Description)</span>
                        <h2 class="txt-lr txt-black no-mar">@item.VehicleMaker @item.ModelYear @item.VehicleModel </h2>
                        <h3 class="txt-sm  txt-mgray dis-block xs-mar">@item.RegisterationPlace</h3>
                    </header>

                    @Html.Partial("_VehiclePlate", item.VehiclePlate)

                    <div class="col-xs-12 col-lg-2 over-hidden">
                        <span class="txt-sm  txt-mgray dis-block ">@Html.Raw(Tameenk.LangText.SadadNo)</span>
                        <h2 class="txt-lr txt-black no-mar">@item.SadadBillNo</h2>

                        <span class="txt-sm  txt-mgray dis-block ">@Html.Raw(Tameenk.LangText.checkout_total)</span>
                        <h2 class="txt-lr txt-black no-mar">@item.TotalPrice </h2>

                        <span class="txt-sm  txt-mgray dis-block ">@Html.Raw(Tameenk.LangText.BillDueDate)</span>
                        <h2 class="txt-lr txt-black no-mar">@item.InvoiceDueDate</h2>

                        <span class="txt-sm  txt-mgray dis-block ">@Html.Raw(Tameenk.LangText.Status)</span>
                        @if (item.BillStatusId != 1)
                        {
                            <h2 class="txt-lr txt-black no-mar">@Html.Raw(Tameenk.LangText.Payed)</h2>
                        }
                        else
                        {
                            <h2 class="txt-lr txt-black no-mar">@Html.Raw(Tameenk.LangText.WaitForPayment)</h2>
                        }
                    </div>

                    <span id="expired-text" class="hidden">@Html.Raw(Tameenk.LangText.expired)</span>
                    <center><span class="expiryDateHolder hide" dir="ltr">@item.RemainingTimeToExpireInSeconds</span></center>
                </div>
            </div>
        }

        <script type="text/javascript">
            function quotationExpiryCountDown(e) {
                // get RemainingTimeToExpireInSeconds
                let countDownDate = new Number(e.innerText),
                    x = setInterval(function () {
                        let distance = countDownDate -= 1,
                            hours = Math.floor(distance / 3600),
                            minutes = Math.floor(distance % 3600 / 60),
                            seconds = Math.floor(distance % 3600 % 60);
                        if (distance > 0) {
                            if (hours > 0) {
                                e.innerText = hours + " : " + minutes + " : " + seconds;
                                e.classList.remove("hide");
                            } else {
                                e.innerText = minutes + " : " + seconds;
                                e.classList.remove("hide");
                            }
                        } else {
                            clearInterval(x);
                            e.innerText = document.getElementById('expired-text').innerText;
                            e.classList.remove("hide");
                        }
                    }, 1000);
            }
            (function () {
                document.querySelectorAll('.expiryDateHolder').forEach(function (e) {
                    quotationExpiryCountDown(e);
                });
            })();
        </script>

        <div>
            @if (Model.Lang == "en")
            {
                <ul class="pagination">
                    @if (Model.CurrentPage == 1)
                    {
                        @*<li><a class="not-active previous"> @Html.Raw(Tameenk.LangText.First) </a></li>*@
                        <li><a class="not-active previous"> @Html.Raw(Tameenk.LangText.Previous) </a></li>
                    }
                    else
                    {
                        @*<li><a class="previous" onclick="GetNextPageData(1)"> @Html.Raw(Tameenk.LangText.First) </a></li>*@
                        <li><a class="previous" onclick="GetNextPageData(@Model.CurrentPage - 1)"> @Html.Raw(Tameenk.LangText.Previous) </a></li>
                    }

                    @if (pagesCount <= 5)
                    {
                        if (pagesCount == 1)
                        {
                            <li><a class="active"> 1 </a></li>
                        }

                        else
                        {
                            for (int i = 1; i <= pagesCount; i++)
                            {
                                if (Model.CurrentPage == i)
                                {
                                    <li><a class="active" onclick="GetNextPageData(@i)"> @i </a></li>
                                }
                                else
                                {
                                    <li><a onclick="GetNextPageData(@i)"> @i </a></li>
                                }
                            }
                        }
                    }

                    else
                    {
                        if (Model.CurrentPage <= 3)
                        {
                            for (int i = 1; i <= 5; i++)
                            {
                                if (Model.CurrentPage == i)
                                {
                                    <li><a class="active" onclick="GetNextPageData(@i)"> @i </a></li>
                                }
                                else
                                {
                                    <li><a onclick="GetNextPageData(@i)"> @i </a></li>
                                }
                            }
                        }
                        else if (Model.CurrentPage >= pagesCount - 1)
                        {
                            if (Model.CurrentPage == pagesCount - 1)
                            {
                                for (int i = Model.CurrentPage - 3; i <= pagesCount; i++)
                                {
                                    if (Model.CurrentPage == i)
                                    {
                                        <li><a class="active" onclick="GetNextPageData(@i)"> @i </a></li>
                                    }
                                    else
                                    {
                                        <li><a onclick="GetNextPageData(@i)"> @i </a></li>
                                    }
                                }
                            }
                            else
                            {
                                for (int i = Model.CurrentPage - 4; i <= pagesCount; i++)
                                {
                                    if (Model.CurrentPage == i)
                                    {
                                        <li><a class="active" onclick="GetNextPageData(@i)"> @i </a></li>
                                    }
                                    else
                                    {
                                        <li><a onclick="GetNextPageData(@i)"> @i </a></li>
                                    }
                                }
                            }
                        }
                        else
                        {
                            for (int j = Model.CurrentPage - 2; j <= Model.CurrentPage + 2; j++)
                            {
                                if (Model.CurrentPage == j)
                                {
                                    <li><a class="active" onclick="GetNextPageData(@j)"> @j </a></li>
                                }
                                else
                                {
                                    <li><a onclick="GetNextPageData(@j)"> @j </a></li>
                                }
                            }
                        }
                    }

                    @if (Model.CurrentPage == pagesCount)
                    {
                        <li><a class="not-active next"> @Html.Raw(Tameenk.LangText.Next) </a></li>
                        @*<li><a class="not-active next"> @Html.Raw(Tameenk.LangText.Last) </a></li>*@
                    }
                    else
                    {
                        <li><a class="next" onclick="GetNextPageData(@Model.CurrentPage + 1)"> @Html.Raw(Tameenk.LangText.Next) </a></li>
                        @*<li><a class="next" onclick="GetNextPageData(@pagesCount)"> @Html.Raw(Tameenk.LangText.Last) </a></li>*@
                    }
                </ul>
            }
            else
            {
                <ul class="pagination">
                    @if (Model.CurrentPage == 1)
                    {
                        @*<li><a class="not-active previous"> @Html.Raw(Tameenk.LangText.First) </a></li>*@
                        <li><a class="not-active previous"> @Html.Raw(Tameenk.LangText.Previous) </a></li>
                    }
                    else
                    {
                        @*<li><a class="previous" onclick="GetNextPageData(1)"> @Html.Raw(Tameenk.LangText.First) </a></li>*@
                        <li><a class="previous" onclick="GetNextPageData(@Model.CurrentPage - 1)"> @Html.Raw(Tameenk.LangText.Previous) </a></li>
                    }

                    @if (pagesCount <= 5)
                    {
                        if (pagesCount == 1)
                        {
                            <li><a class="active"> 1 </a></li>
                        }

                        else
                        {
                            for (double i = pagesCount; i >= 1; i--)
                            {
                                if (Model.CurrentPage == i)
                                {
                                    <li><a class="active" onclick="GetNextPageData(@i)"> @i </a></li>
                                }
                                else
                                {
                                    <li><a onclick="GetNextPageData(@i)"> @i </a></li>
                                }
                            }
                        }
                    }

                    else
                    {
                        if (Model.CurrentPage <= 3)
                        {
                            for (int i = 5; i >= 1; i--)
                            {
                                if (Model.CurrentPage == i)
                                {
                                    <li><a class="active" onclick="GetNextPageData(@i)"> @i </a></li>
                                }
                                else
                                {
                                    <li><a onclick="GetNextPageData(@i)"> @i </a></li>
                                }
                            }
                        }
                        else if (Model.CurrentPage >= pagesCount - 1)
                        {
                            if (Model.CurrentPage == pagesCount - 1)
                            {
                                for (double i = pagesCount; i >= Model.CurrentPage - 3; i--)
                                {
                                    if (Model.CurrentPage == i)
                                    {
                                        <li><a class="active" onclick="GetNextPageData(@i)"> @i </a></li>
                                    }
                                    else
                                    {
                                        <li><a onclick="GetNextPageData(@i)"> @i </a></li>
                                    }
                                }
                            }
                            else
                            {
                                for (double i = pagesCount; i >= Model.CurrentPage - 4; i--)
                                {
                                    if (Model.CurrentPage == i)
                                    {
                                        <li><a class="active" onclick="GetNextPageData(@i)"> @i </a></li>
                                    }
                                    else
                                    {
                                        <li><a onclick="GetNextPageData(@i)"> @i </a></li>
                                    }
                                }
                            }
                        }
                        else
                        {
                            for (int j = Model.CurrentPage + 2; j >= Model.CurrentPage - 2; j--)
                            {
                                if (Model.CurrentPage == j)
                                {
                                    <li><a class="active" onclick="GetNextPageData(@j)"> @j </a></li>
                                }
                                else
                                {
                                    <li><a onclick="GetNextPageData(@j)"> @j </a></li>
                                }
                            }
                        }
                    }

                    @if (Model.CurrentPage == pagesCount)
                    {
                        <li><a class="not-active next"> @Html.Raw(Tameenk.LangText.Next) </a></li>
                        @*<li><a class="not-active next"> @Html.Raw(Tameenk.LangText.Last) </a></li>*@
                    }
                    else
                    {
                        <li><a class="next" onclick="GetNextPageData(@Model.CurrentPage + 1)"> @Html.Raw(Tameenk.LangText.Next) </a></li>
                        @*<li><a class="next" onclick="GetNextPageData(@pagesCount)"> @Html.Raw(Tameenk.LangText.Last) </a></li>*@
                    }
                </ul>
            }
        </div>
    }

    else
    {
        <div class="wrapper-bx md-mar vehicle-row search-info bg-ofwhite section  active search-car">
            <div class="row">
                @Html.Raw(ProfileResources.NoDataFound)
            </div>
        </div>
    }
</article>